<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <script type="text/javascript" src="https://d3js.org/d3.v4.js"></script>
        <style type="text/css">
        </style>
    </head>
    <body>
        <h1> Team 1 </h1>
        <script type="text/javascript">
        
            //Width and height
			var w = 800;
			var h = 300;
			var padding = 40;
			
			var dataset, xScale, yScale, xAxis, yAxis;  //Empty, for now

            //For converting strings to Dates
			var parseTime = d3.timeParse("%Y-%m-%d");

			//For converting Dates to strings
			var formatTime = d3.timeFormat("%Y");

			//Load in data
			d3.csv("Data/stocks_combined.csv", function(error, data) {
				if (error) throw error;
				
				data.forEach(function(d) {
					d.date= parseTime(d.date),  //new Date(+d.year, (+d.month - 1)) Make a new Date object for each year + month
					d.ms_close= +parseFloat(d.MSFT),  //Convert from string to float
					d.am_close= +parseFloat(d.AMZN),
					d.co_close= +parseFloat(d.COST),
					d.al_close= +parseFloat(d.ALK),
					d.sb_close= +parseFloat(d.SBUX)
				});

				dataset = data

				//Create scale functions
				xScale = d3.scaleTime()
							   .domain([
									d3.min(dataset, function(d) { return d.date; }),
									d3.max(dataset, function(d) { return d.date; })
								])
							   .range([padding, w]);

				yScale = d3.scaleLinear()
								.domain([
									d3.min(dataset, function(d) { return Math.min(d.ms_close,d.am_close,d.co_close,d.al_close,d.sb_close); }) - 10,
									d3.max(dataset, function(d) { return Math.max(d.ms_close,d.am_close,d.co_close,d.al_close,d.sb_close); })
								])
								.range([h - padding, 0]);

				//Define axes
				xAxis = d3.axisBottom()
						   .scale(xScale)
						   .ticks(10)
						   .tickFormat(formatTime);

				//Define Y axis
				yAxis = d3.axisLeft()
						   .scale(yScale)
						   .ticks(10);

				//Define line generators
				var ms_line = d3.line()
							//.defined(function(d) { return d.close >= 0 && d.close <= 350; })
							.x(function(d) { return xScale(d.date); })
							.y(function(d) { return yScale(d.ms_close); });
				var am_line = d3.line()
							//.defined(function(d) { return d.close >= 0 && d.close <= 350; })
							.x(function(d) { return xScale(d.date); })
							.y(function(d) { return yScale(d.am_close); });
				var co_line = d3.line()
							//.defined(function(d) { return d.close >= 0 && d.close <= 350; })
							.x(function(d) { return xScale(d.date); })
							.y(function(d) { return yScale(d.co_close); });
				var al_line = d3.line()
							//.defined(function(d) { return d.close >= 0 && d.close <= 350; })
							.x(function(d) { return xScale(d.date); })
							.y(function(d) { return yScale(d.al_close); });
				var sb_line = d3.line()
							//.defined(function(d) { return d.close >= 0 && d.close <= 350; })
							.x(function(d) { return xScale(d.date); })
							.y(function(d) { return yScale(d.sb_close); });
				
				//Create SVG element
				var svg = d3.select("body")
							.append("svg")
							.attr("width", w)
							.attr("height", h);

				//Create lines
				svg.append("path")
					.datum(dataset)
					.attr("class", "line")
					.attr("d", ms_line);
				
				svg.append("path")
					.datum(dataset)
					.attr("class", "line")
					.style("stroke", "red")
					.attr("d", am_line);

				svg.append("path")
					.datum(dataset)
					.attr("class", "line")
					.style("stroke", "black")
					.attr("d", al_line);
				svg.append("path")
					.datum(dataset)
					.attr("class", "line")
					.style("stroke", "green")
					.attr("d", co_line);
				svg.append("path")
					.datum(dataset)
					.attr("class", "line")
					.style("stroke", "orange")
					.attr("d", sb_line);


				//Create axes
				svg.append("g")
					.attr("class", "axis")
					.attr("transform", "translate(0," + (h - padding) + ")")
					.call(xAxis);

				svg.append("g")
					.attr("class", "axis")
					.attr("transform", "translate(" + padding + ",0)")
					.call(yAxis);


			});

        </script>
    </body>
</html>
